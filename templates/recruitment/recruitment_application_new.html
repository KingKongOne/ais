{% extends "base.html" %}
{% load crispy_forms_tags %}
{% block content %}
<div class="container">
  <div class="row">
    <h3>New application</h3>
    <hr>
  </div>
<div class="row">
<form method="post" action="" enctype="multipart/form-data">
{% csrf_token %}
    {% for key in role_keys %}

        <div class="form-group">
            <label>Role {{ forloop.counter }}</label>
            <select class="form-control" name="{{  key }}">
            <option value="">---------</option>
            {% for role in roles %}
                <option value="{{ role.id }}">{{ role }}</option>
            {%  endfor %}
            </select>
        </div>

    {% endfor %}


                {% for question, answer in custom_fields %}
                    {% if question.field_type == 'text_field' %}
                        <div class="form-group">
                            <label for="{{ question.id }}">{{ question.question }}</label>
                            <input type="text" class="form-control" id="{{ question.id }}" name="{{ question.id }}"
                                   value="{{ answer.answer }}">
                        </div>
                    {% elif question.field_type == 'check_box' %}
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="{{ question.id }}" {% if answer %}
                                       checked {% endif %}> {{ question.question }}
                            </label>
                        </div>
                    {% elif question.field_type == 'text_area' %}
                        <div class="form-group">
                            <label for="{{ question.id }}">{{ question.question }}</label>
                            <textarea class="form-control" rows="3" id="{{ question.id }}"
                                      name="{{ question.id }}">{{ answer.answer }}</textarea>
                        </div>
                    {% elif question.field_type == 'radio_buttons' %}
                        <label class="radio control-label">{{ question }}</label>
                        {% for argument in question.customfieldargument_set.all %}
                            <div class="radio">
                                <label>
                                    <input type="radio" name="{{ question.id }}" value="{{ argument.id }}"
                                            {% if answer.answer == argument.id_as_string %} checked {% endif %}> {{ argument.value }}
                                </label>
                            </div>
                        {% endfor %}
                    {% elif question.field_type == 'file' %}
                        <div class="form-group">
                            <label for="{{ question.id }}">{{ question }}</label>
                            <input type="file" id="{{ question.id }}" name="{{ question.id }}">
                            <p><a href="/media/{{ answer.answer }}">{{ answer.answer }}</a></p>
                        </div>
                    {% elif question.field_type == 'image' %}
                        <div class="form-group">
                            <label for="{{ question.id }}">{{ question }}</label>
                            <input type="file" id="{{ question.id }}" name="{{ question.id }}" accept="image/*">
                            {% if answer.answer %}
                                <br>
                                <div><img src="/media/{{ answer.answer }}" width="500"></div>
                            {% endif %}

                        </div>
                    {% else %}
                        UNKNOWN FIELD TYPE!
                    {% endif %}
                {% endfor %}


<button type="submit" class="btn btn-primary">Submit</button>
</form>

</div>
    </div>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
<script>
$(document).ready(function() {
    $('.datepicker').datepicker();
});
</script>
{% endblock %}
